

\Caml(
open Diagrams

    let xmodto ?width:(width=1.5) a = xarrow 
      ~where:(fun m ms env -> 
	let x,y = default_where m ms env in
	(x, y +. 0.5 *. width))
      ~decoration:(fun env l m ms ->
	let e = Edge.(make [draw;lineWidth 0.1;arrow]) ms.(0).(0) ms.(0).(1) in
	let (x,y) = e.anchor (`Temporal 0.5) in
	let y0 = y -. 0.5 *. width in
	let y1 = y +. 0.5 *. width in
	let dash = Edge.(make [draw;lineWidth 0.05] (coord (x,y0)) (coord (x,y1))) in
	[e;dash]) 
      a

    let xtostar = xarrow ~decoration:(fun env l m ms ->
      let e = Edge.(make [draw;lineWidth 0.1;arrow]) ms.(0).(0) ms.(0).(1) in
      let s = Node.(make env [innerSep 0.;outerSep 0.;at (ms.(0).(1).anchor `NorthWest) ; anchor `South] 
		    <<$\lambda$>>)
      in
      [s;e]
    )

)


$A \xto{Agbcde} pPq$

$A \xmodto{Agbcde} pPq$

$A \xtostar{Agbcde} pPq$

$a \xto{\id([])} b$

$$s_1 \xto{τ} s_2 \xto{a} s_3 \xto{τ} s_4$$
